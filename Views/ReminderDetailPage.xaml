<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:BrainWave.APP.ViewModels"
             x:Class="BrainWave.APP.Views.ReminderDetailPage"
             Title="Reminder Details"
             BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#1A1A1A}">

    <ContentPage.BindingContext>
        <vm:ReminderDetailViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            
            <!-- Header -->
            <Frame BackgroundColor="{AppThemeBinding Light=#4A90E2, Dark=#2C5AA0}" 
                   CornerRadius="16" 
                   Padding="20" 
                   HasShadow="True">
                <Grid ColumnDefinitions="Auto,*,Auto">
                    <Button Grid.Column="0"
                            Text="← Back" 
                            Command="{Binding BackCommand}" 
                            BackgroundColor="Transparent" 
                            TextColor="White" 
                            FontSize="16" 
                            FontAttributes="Bold" 
                            Padding="0" />
                    
                    <VerticalStackLayout Grid.Column="1" Spacing="8" HorizontalOptions="Center">
                        <Label Text="⏰ Reminder Details" 
                               FontSize="24" 
                               FontAttributes="Bold" 
                               TextColor="White" 
                               HorizontalOptions="Center" />
                        <Label Text="{Binding Reminder.Title}" 
                               FontSize="18" 
                               TextColor="White" 
                               HorizontalOptions="Center" 
                               HorizontalTextAlignment="Center" />
                    </VerticalStackLayout>
                    
                    <Label Grid.Column="2" Text="" /> <!-- Spacer for symmetry -->
                </Grid>
            </Frame>

            <!-- Reminder Information -->
            <Frame BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#2D2D2D}" 
                   CornerRadius="16" 
                   Padding="20" 
                   HasShadow="True">
                <VerticalStackLayout Spacing="16">
                    
                    <!-- Title -->
                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">
                        <Label Grid.Column="0" 
                               Text="Title:" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                               VerticalOptions="Center" />
                        <Label Grid.Column="1" 
                               Text="{Binding Reminder.Title}" 
                               FontSize="16" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" 
                               VerticalOptions="Center"
                               BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#404040}"
                               Padding="8,4"
                               Margin="0,2" />
                        <Button Grid.Column="2" 
                                Text="Edit" 
                                BackgroundColor="{AppThemeBinding Light=#FF9800, Dark=#F57C00}" 
                                TextColor="White" 
                                CornerRadius="8" 
                                WidthRequest="50" 
                                HeightRequest="30" 
                                FontSize="12"
                                Clicked="EditTitle_Clicked" />
                    </Grid>

                    <!-- Description -->
                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">
                        <Label Grid.Column="0" 
                               Text="Description:" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                               VerticalOptions="Center" />
                        <Label Grid.Column="1" 
                               Text="{Binding Reminder.Description}" 
                               FontSize="16" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" 
                               VerticalOptions="Center"
                               BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#404040}"
                               Padding="8,4"
                               Margin="0,2" />
                        <Button Grid.Column="2" 
                                Text="Edit" 
                                BackgroundColor="{AppThemeBinding Light=#FF9800, Dark=#F57C00}" 
                                TextColor="White" 
                                CornerRadius="8" 
                                WidthRequest="50" 
                                HeightRequest="30" 
                                FontSize="12"
                                Clicked="EditDescription_Clicked" />
                    </Grid>

                    <!-- Reminder Time -->
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Reminder Time:" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" />
                        
                        <!-- Date Picker -->
                        <Frame BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#404040}" 
                               CornerRadius="8" 
                               Padding="12" 
                               HasShadow="False">
                            <VerticalStackLayout Spacing="8">
                                <Label Text="Date:" 
                                       FontSize="14" 
                                       FontAttributes="Bold" 
                                       TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" />
                                <DatePicker x:Name="ReminderDatePicker"
                                           Date="{Binding Reminder.ReminderTime}"
                                           Format="MMM dd, yyyy"
                                           TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                                           BackgroundColor="Transparent"
                                           DateSelected="ReminderDatePicker_DateSelected" />
                            </VerticalStackLayout>
                        </Frame>
                        
                        <!-- Time Picker -->
                        <Frame BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#404040}" 
                               CornerRadius="8" 
                               Padding="12" 
                               HasShadow="False">
                            <VerticalStackLayout Spacing="8">
                                <Label Text="Time:" 
                                       FontSize="14" 
                                       FontAttributes="Bold" 
                                       TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" />
                                <TimePicker x:Name="ReminderTimePicker"
                                           Time="{Binding Reminder.ReminderTime.TimeOfDay}"
                                           TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                                           BackgroundColor="Transparent"
                                           PropertyChanged="ReminderTimePicker_PropertyChanged" />
                            </VerticalStackLayout>
                        </Frame>
                    </VerticalStackLayout>

                    <!-- Reminder Type -->
                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">
                        <Label Grid.Column="0" 
                               Text="Reminder Type:" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                               VerticalOptions="Center" />
                        <Label Grid.Column="1" 
                               Text="Email" 
                               FontSize="16" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" 
                               VerticalOptions="Center"
                               BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#404040}"
                               Padding="8,4"
                               Margin="0,2" />
                        <Label Grid.Column="2" Text="" /> <!-- Spacer for symmetry -->
                    </Grid>

                    <!-- Related Task -->
                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">
                        <Label Grid.Column="0" 
                               Text="Related Task:" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                               VerticalOptions="Center" />
                        <Picker Grid.Column="1" 
                                ItemsSource="{Binding AvailableTasks}"
                                SelectedItem="{Binding SelectedTask}"
                                ItemDisplayBinding="{Binding Title}"
                                BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#404040}"
                                TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                                FontSize="16"
                                Margin="0,2" />
                        <Label Grid.Column="2" Text="" /> <!-- Spacer for symmetry -->
                    </Grid>

                </VerticalStackLayout>
            </Frame>

            <!-- Action Buttons -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
                <Button Grid.Column="0"
                        Text="💾 Confirm Update" 
                        BackgroundColor="{AppThemeBinding Light=#4CAF50, Dark=#388E3C}" 
                        TextColor="White" 
                        CornerRadius="12" 
                        FontSize="14" 
                        FontAttributes="Bold" 
                        HeightRequest="50"
                        Clicked="ConfirmUpdate_Clicked" />
                
                <Button Grid.Column="1"
                        Text="🗑️ Delete" 
                        BackgroundColor="{AppThemeBinding Light=#F44336, Dark=#D32F2F}" 
                        TextColor="White" 
                        CornerRadius="12" 
                        FontSize="14" 
                        FontAttributes="Bold" 
                        HeightRequest="50"
                        Clicked="DeleteReminder_Clicked" />
            </Grid>

            <ActivityIndicator IsVisible="{Binding IsBusy}" 
                              IsRunning="{Binding IsBusy}" 
                              Color="{AppThemeBinding Light=#4A90E2, Dark=#2C5AA0}" />

            <Label Text="{Binding ErrorMessage}" 
                   TextColor="Red" 
                   HorizontalOptions="Center"
                   FontSize="14" 
                   IsVisible="{Binding ErrorMessage, Converter={StaticResource StringToBoolConverter}}" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
