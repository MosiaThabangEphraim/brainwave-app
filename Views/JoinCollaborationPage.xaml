<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:BrainWave.APP.ViewModels"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             x:Class="BrainWave.APP.Views.JoinCollaborationPage"
             Title="Join Collaboration"
             BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#1A1A1A}">

    <ContentPage.BindingContext>
        <vm:CollaborationViewModel />
    </ContentPage.BindingContext>

    <Grid RowDefinitions="Auto,*">
        
        <!-- Header -->
        <Frame Grid.Row="0" 
               BackgroundColor="{AppThemeBinding Light=#4A90E2, Dark=#2C5AA0}" 
               CornerRadius="0" 
               Padding="20" 
               Margin="0,0,0,10">
            <Grid ColumnDefinitions="*,Auto">
                <VerticalStackLayout Grid.Column="0">
                    <Label Text="ðŸ”— Join Collaboration" 
                           FontSize="24" 
                           FontAttributes="Bold" 
                           TextColor="White" />
                    <Label Text="Enter a collaboration token to join" 
                           FontSize="14" 
                           TextColor="White" 
                           Opacity="0.9" />
                </VerticalStackLayout>
                <Button Grid.Column="1"
                        Text="â† Back"
                        BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#FFFFFF}"
                        TextColor="{AppThemeBinding Light=#4A90E2, Dark=#4A90E2}"
                        CornerRadius="8"
                        FontSize="12"
                        FontAttributes="Bold"
                        Padding="12,8"
                        VerticalOptions="Center"
                        Clicked="BackButton_Clicked" />
            </Grid>
        </Frame>

        <!-- Join Collaboration Form -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Padding="20" Spacing="16">
                
                <Label Text="ðŸ”— Join Collaboration" 
                       FontSize="24" 
                       FontAttributes="Bold" 
                       TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                       HorizontalOptions="Center" />
                
                <Frame BackgroundColor="{AppThemeBinding Light=#FFF3E0, Dark=#E65100}" 
                       CornerRadius="12" 
                       Padding="16" 
                       HasShadow="False">
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Enter the collaboration token you received" 
                               FontSize="14" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#F57C00, Dark=#FFB74D}"
                               HorizontalOptions="Center" />
                        
                        <Frame BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#424242}" 
                               CornerRadius="8" 
                               Padding="12" 
                               HasShadow="False">
                            <Entry Text="{Binding JoinToken}" 
                                   Placeholder="Enter collaboration token..." 
                                   BackgroundColor="Transparent" 
                                   TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                                   PlaceholderColor="{AppThemeBinding Light=#999999, Dark=#AAAAAA}"
                                   FontSize="16"
                                   HorizontalTextAlignment="Center" />
                        </Frame>
                    </VerticalStackLayout>
                </Frame>

                <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#404040}" 
                       CornerRadius="12" 
                       Padding="16" 
                       HasShadow="False">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Your Role *" 
                               FontSize="12" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" />
                        <Entry Text="{Binding JoinRole}" 
                               BackgroundColor="Transparent" 
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                               PlaceholderColor="{AppThemeBinding Light=#999999, Dark=#AAAAAA}"
                               Placeholder="Enter your role (e.g., Developer, Designer, Manager)" />
                    </VerticalStackLayout>
                </Frame>

                <!-- Action Buttons -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                    <Button Grid.Column="0"
                            Text="Join Collaboration" 
                            Command="{Binding JoinCollaborationCommand}" 
                            BackgroundColor="{AppThemeBinding Light=#4CAF50, Dark=#2E7D32}" 
                            TextColor="White" 
                            CornerRadius="12" 
                            FontSize="16" 
                            FontAttributes="Bold" 
                            HeightRequest="50"
                            IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBoolConverter}}" />
                    
                    <Button Grid.Column="1"
                            Text="Cancel" 
                            BackgroundColor="{AppThemeBinding Light=#6C757D, Dark=#495057}" 
                            TextColor="White" 
                            CornerRadius="12" 
                            FontSize="16" 
                            FontAttributes="Bold" 
                            HeightRequest="50"
                            Clicked="CancelButton_Clicked" />
                </Grid>

                <ActivityIndicator IsVisible="{Binding IsBusy}" 
                                  IsRunning="{Binding IsBusy}" 
                                  Color="{AppThemeBinding Light=#4A90E2, Dark=#2C5AA0}" />
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>



