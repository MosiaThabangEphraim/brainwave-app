<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:BrainWave.APP.ViewModels"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             x:Class="BrainWave.APP.Views.CreateCollaborationPage"
             Title="Create Collaboration"
             BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#1A1A1A}">

    <ContentPage.BindingContext>
        <vm:CollaborationViewModel />
    </ContentPage.BindingContext>

    <Grid RowDefinitions="Auto,*">
        
        <!-- Header -->
        <Frame Grid.Row="0" 
               BackgroundColor="{AppThemeBinding Light=#4A90E2, Dark=#2C5AA0}" 
               CornerRadius="0" 
               Padding="20" 
               Margin="0,0,0,10">
            <Grid ColumnDefinitions="*,Auto">
                <VerticalStackLayout Grid.Column="0">
                    <Label Text="ðŸ¤ Create Collaboration" 
                           FontSize="24" 
                           FontAttributes="Bold" 
                           TextColor="White" />
                    <Label Text="Start collaborating on your tasks" 
                           FontSize="14" 
                           TextColor="White" 
                           Opacity="0.9" />
                </VerticalStackLayout>
                <Button Grid.Column="1"
                        Text="â† Back"
                        BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#FFFFFF}"
                        TextColor="{AppThemeBinding Light=#4A90E2, Dark=#4A90E2}"
                        CornerRadius="8"
                        FontSize="12"
                        FontAttributes="Bold"
                        Padding="12,8"
                        VerticalOptions="Center"
                        Clicked="BackButton_Clicked" />
            </Grid>
        </Frame>

        <!-- Create Collaboration Form -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Padding="20" Spacing="16">
                
                <Label Text="{Binding FormTitle}" 
                       FontSize="24" 
                       FontAttributes="Bold" 
                       TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                       HorizontalOptions="Center" />
                
                <!-- Task Selection -->
                <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#404040}" 
                       CornerRadius="12" 
                       Padding="16" 
                       HasShadow="False">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="ðŸ“‹ Select Task *" 
                               FontSize="12" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" />
                        <Picker x:Name="TaskPicker"
                                ItemsSource="{Binding AvailableTasks}"
                                ItemDisplayBinding="{Binding Title}"
                                SelectedItem="{Binding SelectedTask}"
                                BackgroundColor="Transparent"
                                TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                                FontSize="14"
                                Title="Choose a task...">
                        </Picker>
                    </VerticalStackLayout>
                </Frame>
                
                <!-- Form Fields -->
                <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#404040}" 
                       CornerRadius="12" 
                       Padding="16" 
                       HasShadow="False">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Collaboration Name *" 
                               FontSize="12" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" />
                        <Entry Text="{Binding Editing.Name}" 
                               BackgroundColor="Transparent" 
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                               PlaceholderColor="{AppThemeBinding Light=#999999, Dark=#AAAAAA}" />
                    </VerticalStackLayout>
                </Frame>

                <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#404040}" 
                       CornerRadius="12" 
                       Padding="16" 
                       HasShadow="False">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Description (Optional)" 
                               FontSize="12" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" />
                        <Editor Text="{Binding Editing.Description}" 
                                BackgroundColor="Transparent" 
                                TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                                PlaceholderColor="{AppThemeBinding Light=#999999, Dark=#AAAAAA}"
                                HeightRequest="80" />
                    </VerticalStackLayout>
                </Frame>

                <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#404040}" 
                       CornerRadius="12" 
                       Padding="16" 
                       HasShadow="False">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Your Role *" 
                               FontSize="12" 
                               FontAttributes="Bold" 
                               TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}" />
                        <Entry Text="{Binding Editing.Role}" 
                               BackgroundColor="Transparent" 
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                               PlaceholderColor="{AppThemeBinding Light=#999999, Dark=#AAAAAA}"
                               Placeholder="Enter your role (e.g., Developer, Designer, Manager)" />
                    </VerticalStackLayout>
                </Frame>

                <!-- Action Buttons -->
                <Button Text="Create Collaboration" 
                        Command="{Binding CreateCommand}" 
                        BackgroundColor="{AppThemeBinding Light=#4A90E2, Dark=#2C5AA0}" 
                        TextColor="White" 
                        CornerRadius="12" 
                        FontSize="16" 
                        FontAttributes="Bold" 
                        HeightRequest="50"
                        IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBoolConverter}}" />

                <ActivityIndicator IsVisible="{Binding IsBusy}" 
                                  IsRunning="{Binding IsBusy}" 
                                  Color="{AppThemeBinding Light=#4A90E2, Dark=#2C5AA0}" />
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>